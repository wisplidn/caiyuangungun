(TraeAI-11) ~/ä¸ªäººæ–‡æ¡£/caiyuangungun [0] $ cd /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun && python src/caiyua
ngungun/data/norm/tests/example_processor_service.py
2025-09-29 10:31:06 - numexpr.utils - INFO - Note: NumExpr detected 12 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-09-29 10:31:06 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-09-29 10:31:06 - __main__ - INFO - å¼€å§‹è¿è¡ŒProcessorServiceå®Œæ•´æµ‹è¯•å¥—ä»¶
2025-09-29 10:31:06 - __main__ - INFO - ============================================================
2025-09-29 10:31:06 - __main__ - INFO - 
å¼€å§‹æµ‹è¯•: é…ç½®ç®¡ç†å™¨é›†æˆ
2025-09-29 10:31:06 - __main__ - INFO - ----------------------------------------
2025-09-29 10:31:06 - __main__ - INFO - === æµ‹è¯•ï¼šé…ç½®ç®¡ç†å™¨é›†æˆ ===
2025-09-29 10:31:06 - __main__ - INFO - âœ“ è·å–å¤„ç†å™¨é…ç½®æˆåŠŸ
2025-09-29 10:31:06 - __main__ - INFO -   é…ç½®æè¿°: åˆ©æ¶¦è¡¨æ•°æ®ä¸“ç”¨æ¸…æ´—æµç¨‹ï¼ŒåŒ…å«è¡Œå¤„ç†ã€åˆ—å¤„ç†ã€è´¨æ£€å’Œè¾“å‡ºç­‰å®Œæ•´æ­¥éª¤
2025-09-29 10:31:06 - __main__ - INFO - âœ“ è·å–å¤„ç†æµæ°´çº¿æˆåŠŸï¼Œå…± 13 ä¸ªæ­¥éª¤
2025-09-29 10:31:06 - __main__ - INFO - âœ“ è·å–è·¯å¾„é…ç½®æˆåŠŸ
2025-09-29 10:31:06 - __main__ - INFO -   è¾“å…¥è·¯å¾„: data/norm/income_statement/merged/income_y.parquet
2025-09-29 10:31:06 - __main__ - INFO -   è¾“å‡ºè·¯å¾„: data/norm/income_statement/cleaned/income_y.parquet
2025-09-29 10:31:06 - __main__ - INFO - âœ“ é…ç½®ç®¡ç†å™¨é›†æˆ æµ‹è¯•é€šè¿‡
2025-09-29 10:31:06 - __main__ - INFO - ----------------------------------------
2025-09-29 10:31:06 - __main__ - INFO - 
å¼€å§‹æµ‹è¯•: åˆ—å‡ºå¤„ç†å™¨
2025-09-29 10:31:06 - __main__ - INFO - ----------------------------------------
2025-09-29 10:31:06 - __main__ - INFO - === æµ‹è¯•ï¼šåˆ—å‡ºæ‰€æœ‰å¯ç”¨å¤„ç†å™¨ ===
å¯ç”¨å¤„ç†å™¨åˆ—è¡¨ (å…±4ä¸ª):
--------------------------------------------------------------------------------
åç§°: fin_bs_processor
æè¿°: èµ„äº§è´Ÿå€ºè¡¨æ•°æ®ä¸“ç”¨æ¸…æ´—æµç¨‹
è¾“å…¥: data/norm/balancesheet/merged/balancesheet.parquet
è¾“å‡º: data/norm/balancesheet/cleaned/balancesheet.parquet
æ­¥éª¤: 4ä¸ª
ç±»åˆ«: è´¨æ£€, è¡Œå¤„ç†, è¾“å‡ºå¤„ç†
--------------------------------------------------------------------------------
åç§°: fin_cf_processor
æè¿°: ç°é‡‘æµé‡è¡¨æ•°æ®ä¸“ç”¨æ¸…æ´—æµç¨‹
è¾“å…¥: data/norm/cashflow/merged/cashflow_y.parquet
è¾“å‡º: data/norm/cashflow/cleaned/cashflow_y.parquet
æ­¥éª¤: 5ä¸ª
ç±»åˆ«: è´¨æ£€, è¡Œå¤„ç†, è¾“å‡ºå¤„ç†
--------------------------------------------------------------------------------
åç§°: fin_indicator_processor
æè¿°: è´¢åŠ¡æŒ‡æ ‡æ•°æ®ä¸“ç”¨æ¸…æ´—æµç¨‹
è¾“å…¥: data/norm/fina_indicator/merged/fina_indicator_vip.parquet
è¾“å‡º: data/norm/fina_indicator/cleaned/fina_indicator_vip.parquet
æ­¥éª¤: 5ä¸ª
ç±»åˆ«: è´¨æ£€, è¡Œå¤„ç†, è¾“å‡ºå¤„ç†
--------------------------------------------------------------------------------
åç§°: fin_is_processor
æè¿°: åˆ©æ¶¦è¡¨æ•°æ®ä¸“ç”¨æ¸…æ´—æµç¨‹ï¼ŒåŒ…å«è¡Œå¤„ç†ã€åˆ—å¤„ç†ã€è´¨æ£€å’Œè¾“å‡ºç­‰å®Œæ•´æ­¥éª¤
è¾“å…¥: data/norm/income_statement/merged/income_y.parquet
è¾“å‡º: data/norm/income_statement/cleaned/income_y.parquet
æ­¥éª¤: 13ä¸ª
ç±»åˆ«: è´¨æ£€, åˆ—å¤„ç†, è¡Œå¤„ç†, è¾“å‡ºå¤„ç†
--------------------------------------------------------------------------------
2025-09-29 10:31:06 - __main__ - INFO - âœ“ åˆ—å‡ºå¤„ç†å™¨åŠŸèƒ½æ­£å¸¸
2025-09-29 10:31:06 - __main__ - INFO - âœ“ åˆ—å‡ºå¤„ç†å™¨ æµ‹è¯•é€šè¿‡
2025-09-29 10:31:06 - __main__ - INFO - ----------------------------------------
2025-09-29 10:31:06 - __main__ - INFO - 
å¼€å§‹æµ‹è¯•: è·å–å¤„ç†å™¨ä¿¡æ¯
2025-09-29 10:31:06 - __main__ - INFO - ----------------------------------------
2025-09-29 10:31:06 - __main__ - INFO - === æµ‹è¯•ï¼šè·å–å¤„ç†å™¨è¯¦ç»†ä¿¡æ¯ ===
2025-09-29 10:31:06 - __main__ - INFO - âœ“ è·å–å¤„ç†å™¨ä¿¡æ¯æˆåŠŸ
2025-09-29 10:31:06 - __main__ - INFO -   å¤„ç†å™¨åç§°: fin_is_processor
2025-09-29 10:31:06 - __main__ - INFO -   æè¿°: åˆ©æ¶¦è¡¨æ•°æ®ä¸“ç”¨æ¸…æ´—æµç¨‹ï¼ŒåŒ…å«è¡Œå¤„ç†ã€åˆ—å¤„ç†ã€è´¨æ£€å’Œè¾“å‡ºç­‰å®Œæ•´æ­¥éª¤
2025-09-29 10:31:06 - __main__ - INFO -   æ¨¡å—è·¯å¾„: caiyuangungun.data.norm.processors.financials.fin_is_processor
2025-09-29 10:31:06 - __main__ - INFO -   ç±»å: FinISProcessor
2025-09-29 10:31:06 - __main__ - INFO -   æµæ°´çº¿æ­¥éª¤æ•°: 13
2025-09-29 10:31:06 - __main__ - INFO - âœ“ è·å–å¤„ç†å™¨ä¿¡æ¯ æµ‹è¯•é€šè¿‡
2025-09-29 10:31:06 - __main__ - INFO - ----------------------------------------
2025-09-29 10:31:06 - __main__ - INFO - 
å¼€å§‹æµ‹è¯•: æ‰§è¡Œfin_is_processor
2025-09-29 10:31:06 - __main__ - INFO - ----------------------------------------
2025-09-29 10:31:06 - __main__ - INFO - === æµ‹è¯•ï¼šæ‰§è¡Œ fin_is_processor ===
2025-09-29 10:31:06 - caiyuangungun.data.norm.services.processor_service - INFO - å¼€å§‹æ‰§è¡Œå¤„ç†å™¨: fin_is_processor
2025-09-29 10:31:06 - caiyuangungun.data.norm.services.processor_service - INFO - è¾“å…¥è·¯å¾„: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/income_statement/merged/income_y.parquet
2025-09-29 10:31:06 - caiyuangungun.data.norm.services.processor_service - INFO - è¾“å‡ºè·¯å¾„: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/income_statement/cleaned/income_y.parquet
2025-09-29 10:31:06 - caiyuangungun.data.norm.services.processor_service - INFO - ä»é…ç½®æ–‡ä»¶åŠ è½½å¤„ç†å™¨: fin_is_processor from caiyuangungun.data.norm.processors.financials.fin_is_processor
2025-09-29 10:31:06 - caiyuangungun.data.norm.services.processor_service - INFO - è¯»å–è¾“å…¥æ•°æ®...
2025-09-29 10:31:06 - caiyuangungun.data.norm.services.processor_service - INFO - è¾“å…¥æ•°æ®å½¢çŠ¶: (345685, 100)
2025-09-29 10:31:06 - caiyuangungun.data.norm.services.processor_service - INFO - å¼€å§‹æ‰§è¡Œå¤„ç†æµæ°´çº¿ï¼Œå…±13ä¸ªæ­¥éª¤
2025-09-29 10:31:06 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤1: remove_empty_ts_code (è¡Œå¤„ç†) - å‰”é™¤ts_codeä¸ºç©ºçš„è¡Œï¼Œç¡®ä¿æ¯æ¡è®°å½•éƒ½æœ‰æœ‰æ•ˆçš„è‚¡ç¥¨ä»£ç æ ‡è¯†
2025-09-29 10:31:06 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å¼€å§‹å‰”é™¤ts_codeä¸ºç©ºçš„è¡Œ
2025-09-29 10:31:07 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å‰”é™¤ts_codeä¸ºç©ºçš„è¡Œå®Œæˆï¼ŒåŸå§‹è¡Œæ•°: 345685, å‰”é™¤è¡Œæ•°: 3565, å‰©ä½™è¡Œæ•°: 342120
2025-09-29 10:31:07 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤1å®Œæˆ: (345685, 100) -> (342120, 100), è€—æ—¶: 0.40ç§’
2025-09-29 10:31:07 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤2: drop_columns_and_duplicates (è¡Œå¤„ç†) - å‰”é™¤ebitåˆ—å’Œebitdaåˆ—ï¼Œç„¶åå¯¹æ‰€æœ‰å‰©ä½™åˆ—æ‰§è¡Œåˆ é™¤é‡å¤è¡Œæ“ä½œï¼Œæ¸…ç†æ•°æ®å†—ä½™
2025-09-29 10:31:07 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å¼€å§‹å‰”é™¤ebitå’Œebitdaåˆ—ï¼Œå¹¶åˆ é™¤é‡å¤è¡Œ
2025-09-29 10:31:07 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å·²å‰”é™¤åˆ—: ['ebit', 'ebitda']
2025-09-29 10:31:08 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - åˆ é™¤é‡å¤è¡Œå®Œæˆï¼ŒåŸå§‹è¡Œæ•°: 342120, åˆ é™¤è¡Œæ•°: 5, å‰©ä½™è¡Œæ•°: 342115
2025-09-29 10:31:08 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤2å®Œæˆ: (342120, 100) -> (342115, 98), è€—æ—¶: 1.85ç§’
2025-09-29 10:31:08 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤3: handle_duplicate_records (è¡Œå¤„ç†) - å¤„ç†æ›´æ–°é‡å¤è¡Œï¼šæŒ‰ts_codeã€end_dateã€f_ann_dateåˆ†ç»„ï¼Œæ£€æŸ¥é‡å¤æƒ…å†µã€‚å•æ¡è®°å½•ä¿ç•™ï¼Œä¸¤æ¡è®°å½•æ£€æŸ¥update_flagæ˜¯å¦ä¸º0-1ç»„åˆå¹¶ä¿ç•™update_flag=1çš„è®°å½•ï¼Œè¶…è¿‡ä¸¤æ¡è®°å½•åˆ™æŠ¥é”™
2025-09-29 10:31:08 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å¼€å§‹å¤„ç†æ›´æ–°é‡å¤è¡Œ
2025-09-29 10:31:09 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å‘ç°é‡å¤è®°å½•æ•°é‡: 126528
2025-09-29 10:31:09 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å¤„ç†é‡å¤è®°å½•å®Œæˆï¼Œæœ€ç»ˆè¡Œæ•°: 278851
2025-09-29 10:31:09 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤3å®Œæˆ: (342115, 98) -> (278851, 98), è€—æ—¶: 1.00ç§’
2025-09-29 10:31:09 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤4: create_assets_impair_loss_fixed (åˆ—å¤„ç†) - åˆ›å»ºèµ„äº§å‡å€¼æŸå¤±ä¿®æ­£åˆ—ï¼šå¦‚æœend_date>=20190630ï¼Œåˆ™ç­‰äºassets_impair_lossï¼›å¦åˆ™ç­‰äº-1*assets_impair_lossã€‚è¿™æ˜¯ä¸ºäº†ç»Ÿä¸€ä¸åŒä¼šè®¡å‡†åˆ™ä¸‹çš„ç§‘ç›®æ–¹å‘
2025-09-29 10:31:09 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å¼€å§‹åˆ›å»ºassets_impair_loss_fixedåˆ—
2025-09-29 10:31:10 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - assets_impair_loss_fixedåˆ—åˆ›å»ºå®Œæˆ
2025-09-29 10:31:10 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤4å®Œæˆ: (278851, 98) -> (278851, 99), è€—æ—¶: 0.12ç§’
2025-09-29 10:31:10 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤5: create_credit_impa_loss_fixed (åˆ—å¤„ç†) - åˆ›å»ºä¿¡ç”¨å‡å€¼æŸå¤±ä¿®æ­£åˆ—ï¼šå¦‚æœend_date>=20190630ï¼Œåˆ™ç­‰äºcredit_impa_lossï¼›å¦åˆ™ç­‰äº-1*credit_impa_lossã€‚è¿™æ˜¯ä¸ºäº†ç»Ÿä¸€ä¸åŒä¼šè®¡å‡†åˆ™ä¸‹çš„ç§‘ç›®æ–¹å‘
2025-09-29 10:31:10 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å¼€å§‹åˆ›å»ºcredit_impa_loss_fixedåˆ—
2025-09-29 10:31:10 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - credit_impa_loss_fixedåˆ—åˆ›å»ºå®Œæˆ
2025-09-29 10:31:10 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤5å®Œæˆ: (278851, 99) -> (278851, 100), è€—æ—¶: 0.00ç§’
2025-09-29 10:31:10 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤6: create_total_opcost_fixed (åˆ—å¤„ç†) - åˆ›å»ºè¥ä¸šæ€»æˆæœ¬ä¿®æ­£åˆ—ï¼šå¦‚æœtotal_opcostä¸ä¸ºç©ºåˆ™ä½¿ç”¨åŸå€¼ï¼Œå¦åˆ™è®¡ç®—total_cogs+credit_impa_loss_fixed+assets_impair_loss_fixedã€‚ç¡®ä¿è¥ä¸šæ€»æˆæœ¬æ•°æ®çš„å®Œæ•´æ€§
2025-09-29 10:31:10 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å¼€å§‹åˆ›å»ºtotal_opcost_fixedåˆ—
2025-09-29 10:31:10 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - total_opcost_fixedåˆ—åˆ›å»ºå®Œæˆ
2025-09-29 10:31:10 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤6å®Œæˆ: (278851, 100) -> (278851, 101), è€—æ—¶: 0.00ç§’
2025-09-29 10:31:10 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤7: validate_total_revenue (è´¨æ£€) - è¥ä¸šæ”¶å…¥æ ¸å¯¹ï¼šç­›é€‰comp_type=1çš„è®°å½•ï¼Œè®¡ç®—total_revenue-revenue-int_income-prem_earned-comm_incomeï¼Œæ£€æŸ¥ç»å¯¹å€¼è¯¯å·®å¤§äº5ä¸‡çš„è®°å½•æ•°é‡ï¼Œè¶…è¿‡æ€»è®°å½•1%åˆ™æŠ¥é”™
2025-09-29 10:31:10 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å¼€å§‹è¥ä¸šæ”¶å…¥æ ¸å¯¹
2025-09-29 10:31:11 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - è¥ä¸šæ”¶å…¥æ ¸å¯¹ç»“æœ: æœ‰æ•ˆè®°å½•æ•°=272392, è¯¯å·®>5.0ä¸‡è®°å½•æ•°=377, è¯¯å·®ç‡=0.0014
2025-09-29 10:31:11 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - è¥ä¸šæ”¶å…¥æ ¸å¯¹é€šè¿‡
2025-09-29 10:31:11 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤7å®Œæˆ: (278851, 101) -> (278851, 104), è€—æ—¶: 1.06ç§’
2025-09-29 10:31:11 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤8: validate_total_opcost (è´¨æ£€) - è¥ä¸šæˆæœ¬æ ¸å¯¹ï¼šç­›é€‰comp_type=1çš„è®°å½•ï¼Œè®¡ç®—total_opcost_fixed-(oper_cost+int_exp+comm_exp+biz_tax_surchg+sell_exp+admin_exp+fin_exp+rd_exp)ï¼Œæ£€æŸ¥ç»å¯¹å€¼è¯¯å·®å¤§äº5ä¸‡çš„è®°å½•æ•°é‡ï¼Œè¶…è¿‡æ€»è®°å½•1%åˆ™æŠ¥é”™
2025-09-29 10:31:11 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å¼€å§‹è¥ä¸šæˆæœ¬æ ¸å¯¹
2025-09-29 10:31:12 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - è¥ä¸šæˆæœ¬æ ¸å¯¹ç»“æœ: æœ‰æ•ˆè®°å½•æ•°=270931, è¯¯å·®>5.0ä¸‡è®°å½•æ•°=808, è¯¯å·®ç‡=0.0030
2025-09-29 10:31:12 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - è¥ä¸šæˆæœ¬æ ¸å¯¹é€šè¿‡
2025-09-29 10:31:12 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤8å®Œæˆ: (278851, 104) -> (278851, 107), è€—æ—¶: 1.06ç§’
2025-09-29 10:31:12 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤9: validate_operate_profit (è´¨æ£€) - è¥ä¸šåˆ©æ¶¦æ ¸å¯¹ï¼šç­›é€‰comp_type=1çš„è®°å½•ï¼Œè®¡ç®—operate_profit-(total_revenue-total_opcost_fixed+fv_value_chg_gain+invest_income+assets_impair_loss_fixed+credit_impa_loss_fixed+asset_disp_income+oth_income+forex_gain+net_expo_hedging_benefits)ï¼Œæ£€æŸ¥ç»å¯¹å€¼è¯¯å·®å¤§äº5ä¸‡çš„è®°å½•æ•°é‡ï¼Œè¶…è¿‡æ€»è®°å½•1.5%åˆ™æŠ¥é”™
2025-09-29 10:31:12 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å¼€å§‹è¥ä¸šåˆ©æ¶¦æ ¸å¯¹
2025-09-29 10:31:13 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - è¥ä¸šåˆ©æ¶¦æ ¸å¯¹ç»“æœ: æœ‰æ•ˆè®°å½•æ•°=271971, è¯¯å·®>5ä¸‡è®°å½•æ•°=1618, è¯¯å·®ç‡=0.0059
2025-09-29 10:31:13 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - è¥ä¸šåˆ©æ¶¦æ ¸å¯¹é€šè¿‡
2025-09-29 10:31:13 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤9å®Œæˆ: (278851, 107) -> (278851, 112), è€—æ—¶: 1.07ç§’
2025-09-29 10:31:13 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤10: validate_net_income (è´¨æ£€) - å‡€åˆ©æ¶¦æ ¸å¯¹ï¼šç­›é€‰comp_type=1çš„è®°å½•ï¼Œè®¡ç®—operate_profit-non_oper_income-non_oper_exp-income_tax-n_incomeï¼Œæ£€æŸ¥ç»å¯¹å€¼è¯¯å·®å¤§äº5ä¸‡çš„è®°å½•æ•°é‡ï¼Œè¶…è¿‡æ€»è®°å½•1%åˆ™æŠ¥é”™
2025-09-29 10:31:13 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å¼€å§‹å‡€åˆ©æ¶¦æ ¸å¯¹
2025-09-29 10:31:14 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å‡€åˆ©æ¶¦æ ¸å¯¹ç»“æœ: æœ‰æ•ˆè®°å½•æ•°=272176, è¯¯å·®>5ä¸‡è®°å½•æ•°=595, è¯¯å·®ç‡=0.0022
2025-09-29 10:31:14 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å‡€åˆ©æ¶¦æ ¸å¯¹é€šè¿‡
2025-09-29 10:31:14 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤10å®Œæˆ: (278851, 112) -> (278851, 117), è€—æ—¶: 1.10ç§’
2025-09-29 10:31:14 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤11: validate_unique_records (è´¨æ£€) - é‡å¤è®°å½•è´¨æ£€ï¼šæ£€æŸ¥ts_code+end_date+f_ann_dateç»„åˆæ˜¯å¦å­˜åœ¨é‡å¤ï¼Œå¦‚æœå­˜åœ¨é‡å¤è®°å½•åˆ™æŠ¥é”™ï¼Œç¡®ä¿æ•°æ®çš„å”¯ä¸€æ€§
2025-09-29 10:31:14 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å¼€å§‹é‡å¤è®°å½•è´¨æ£€
2025-09-29 10:31:14 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - é‡å¤è®°å½•è´¨æ£€é€šè¿‡
2025-09-29 10:31:14 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤11å®Œæˆ: (278851, 117) -> (278851, 117), è€—æ—¶: 0.05ç§’
2025-09-29 10:31:14 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤12: rename_fixed_columns (è¾“å‡ºå¤„ç†) - é‡å‘½åä¿®æ­£åˆ—ï¼šå°†total_opcost_fixedã€credit_impa_loss_fixedã€assets_impair_loss_fixedä¸‰åˆ—å»æ‰_fixedåç¼€ï¼Œæ¢å¤ä¸ºæ ‡å‡†å­—æ®µå
2025-09-29 10:31:14 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å¼€å§‹é‡å‘½åä¿®æ­£åˆ—
2025-09-29 10:31:15 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - åˆ é™¤åŸå§‹åˆ—: total_opcost
2025-09-29 10:31:15 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - é‡å‘½ååˆ—: total_opcost_fixed -> total_opcost
2025-09-29 10:31:15 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - åˆ é™¤åŸå§‹åˆ—: credit_impa_loss
2025-09-29 10:31:15 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - é‡å‘½ååˆ—: credit_impa_loss_fixed -> credit_impa_loss
2025-09-29 10:31:15 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - åˆ é™¤åŸå§‹åˆ—: assets_impair_loss
2025-09-29 10:31:15 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - é‡å‘½ååˆ—: assets_impair_loss_fixed -> assets_impair_loss
2025-09-29 10:31:15 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤12å®Œæˆ: (278851, 117) -> (278851, 114), è€—æ—¶: 1.52ç§’
2025-09-29 10:31:15 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤13: output_parquet_file (è¾“å‡ºå¤„ç†) - æŒ‰æŒ‡å®šå­—æ®µé¡ºåºè¾“å‡ºparquetæ–‡ä»¶ï¼šåŒ…å«ts_codeã€f_ann_dateã€end_dateç­‰41ä¸ªæ ‡å‡†å­—æ®µï¼Œä¸æ¶‰åŠçš„å­—æ®µå°†è¢«ä¸¢å¼ƒï¼Œç¡®ä¿è¾“å‡ºæ•°æ®ç»“æ„çš„ä¸€è‡´æ€§
2025-09-29 10:31:15 - caiyuangungun.data.norm.services.processor_service - INFO - è·³è¿‡output_parquet_fileï¼Œå°†åœ¨ä¸»æµç¨‹ä¸­å¤„ç†
2025-09-29 10:31:15 - caiyuangungun.data.norm.services.processor_service - INFO - å¤„ç†æµæ°´çº¿æ‰§è¡Œå®Œæˆ
2025-09-29 10:31:15 - caiyuangungun.data.norm.services.processor_service - INFO - ä½¿ç”¨output_parquet_fileæ–¹æ³•ä¿å­˜ç»“æœåˆ°: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/income_statement/cleaned/income_y.parquet
2025-09-29 10:31:15 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - å¼€å§‹è¾“å‡ºparquetæ–‡ä»¶
2025-09-29 10:31:16 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - parquetæ–‡ä»¶å·²è¾“å‡ºåˆ°: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/income_statement/cleaned/income_y.parquet
2025-09-29 10:31:16 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - è¾“å‡ºæ•°æ®å½¢çŠ¶: (278851, 41)
2025-09-29 10:31:16 - caiyuangungun.data.norm.processors.financials.fin_is_processor - INFO - è¾“å‡ºå­—æ®µæ•°: 41
2025-09-29 10:31:16 - caiyuangungun.data.norm.services.processor_service - INFO - å¤„ç†å™¨æ‰§è¡ŒæˆåŠŸ: fin_is_processor
2025-09-29 10:31:16 - caiyuangungun.data.norm.services.processor_service - INFO - æ•°æ®å½¢çŠ¶å˜åŒ–: (345685, 100) -> (278851, 41)
2025-09-29 10:31:16 - caiyuangungun.data.norm.services.processor_service - INFO - æ‰§è¡Œæ—¶é—´: 10.45ç§’
2025-09-29 10:31:16 - caiyuangungun.data.norm.services.processor_service - INFO - è¾“å‡ºæ–‡ä»¶å¤§å°: 51.13MB
2025-09-29 10:31:16 - __main__ - INFO - âœ“ fin_is_processor æ‰§è¡ŒæˆåŠŸ
2025-09-29 10:31:16 - __main__ - INFO -   å¤„ç†æ—¶é—´: 10.45ç§’
2025-09-29 10:31:16 - __main__ - INFO -   è¾“å…¥æ•°æ®å½¢çŠ¶: (345685, 100)
2025-09-29 10:31:16 - __main__ - INFO -   è¾“å‡ºæ•°æ®å½¢çŠ¶: (278851, 41)
2025-09-29 10:31:16 - __main__ - INFO -   è¾“å‡ºæ–‡ä»¶: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/income_statement/cleaned/income_y.parquet
2025-09-29 10:31:16 - __main__ - INFO -   è¾“å‡ºæ–‡ä»¶å¤§å°: 51.13 MB
2025-09-29 10:31:16 - __main__ - INFO - âœ“ è¾“å‡ºæ–‡ä»¶åˆ›å»ºæˆåŠŸ
2025-09-29 10:31:16 - __main__ - INFO - âœ“ æ‰§è¡Œfin_is_processor æµ‹è¯•é€šè¿‡
2025-09-29 10:31:16 - __main__ - INFO - ----------------------------------------
2025-09-29 10:31:16 - __main__ - INFO - 
å¼€å§‹æµ‹è¯•: æ‰§è¡Œfin_bs_processor
2025-09-29 10:31:16 - __main__ - INFO - ----------------------------------------
2025-09-29 10:31:16 - __main__ - INFO - === æµ‹è¯•ï¼šæ‰§è¡Œ fin_bs_processor ===
2025-09-29 10:31:16 - caiyuangungun.data.norm.services.processor_service - INFO - å¼€å§‹æ‰§è¡Œå¤„ç†å™¨: fin_bs_processor
2025-09-29 10:31:16 - caiyuangungun.data.norm.services.processor_service - INFO - è¾“å…¥è·¯å¾„: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/balancesheet/merged/balancesheet.parquet
2025-09-29 10:31:16 - caiyuangungun.data.norm.services.processor_service - INFO - è¾“å‡ºè·¯å¾„: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/balancesheet/cleaned/balancesheet.parquet
2025-09-29 10:31:16 - caiyuangungun.data.norm.services.processor_service - INFO - ä»é…ç½®æ–‡ä»¶åŠ è½½å¤„ç†å™¨: fin_bs_processor from caiyuangungun.data.norm.processors.financials.fin_bs_processor
2025-09-29 10:31:16 - caiyuangungun.data.norm.processors.financials.fin_bs_processor - ERROR - åŠ è½½é…ç½®æ–‡ä»¶å¤±è´¥: [Errno 2] No such file or directory: '/Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/src/caiyuangungun/data/config/specialized_cleaning_pipeline_config.json'
2025-09-29 10:31:16 - caiyuangungun.data.norm.processors.financials.fin_bs_processor - INFO - FinBSProcessoråˆå§‹åŒ–å®Œæˆï¼Œé…ç½®æ–‡ä»¶: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/src/caiyuangungun/data/config/specialized_cleaning_pipeline_config.json
2025-09-29 10:31:16 - caiyuangungun.data.norm.services.processor_service - INFO - è¯»å–è¾“å…¥æ•°æ®...
2025-09-29 10:31:17 - caiyuangungun.data.norm.services.processor_service - INFO - è¾“å…¥æ•°æ®å½¢çŠ¶: (389933, 164)
2025-09-29 10:31:17 - caiyuangungun.data.norm.services.processor_service - INFO - å¼€å§‹æ‰§è¡Œå¤„ç†æµæ°´çº¿ï¼Œå…±4ä¸ªæ­¥éª¤
2025-09-29 10:31:17 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤1: remove_empty_ts_code (è¡Œå¤„ç†) - å‰”é™¤ts_codeä¸ºç©ºçš„è¡Œï¼Œç¡®ä¿æ¯æ¡è®°å½•éƒ½æœ‰æœ‰æ•ˆçš„è‚¡ç¥¨ä»£ç æ ‡è¯†
2025-09-29 10:31:17 - caiyuangungun.data.norm.processors.financials.fin_bs_processor - INFO - å¼€å§‹ç§»é™¤ts_codeä¸ºç©ºçš„è¡Œ
2025-09-29 10:31:18 - caiyuangungun.data.norm.processors.financials.fin_bs_processor - INFO - ç§»é™¤äº†3580è¡Œts_codeä¸ºç©ºçš„æ•°æ®ï¼Œå‰©ä½™386353è¡Œ
2025-09-29 10:31:18 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤1å®Œæˆ: (389933, 164) -> (386353, 164), è€—æ—¶: 0.81ç§’
2025-09-29 10:31:18 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤2: handle_duplicate_records (è¡Œå¤„ç†) - å¤„ç†æ›´æ–°é‡å¤è¡Œï¼šæŒ‰ts_codeã€end_dateã€f_ann_dateåˆ†ç»„ï¼Œæ£€æŸ¥é‡å¤æƒ…å†µã€‚å•æ¡è®°å½•ä¿ç•™ï¼Œä¸¤æ¡è®°å½•æ£€æŸ¥update_flagæ˜¯å¦ä¸º0-1ç»„åˆå¹¶ä¿ç•™update_flag=1çš„è®°å½•ï¼Œå¦‚æœæ˜¯1-1ç»„åˆåˆ™å–ann_dateæœ€æ–°çš„è®°å½•ï¼Œè¶…è¿‡ä¸¤æ¡è®°å½•åˆ™æŠ¥é”™
2025-09-29 10:31:18 - caiyuangungun.data.norm.processors.financials.fin_bs_processor - INFO - å¼€å§‹å¤„ç†æ›´æ–°é‡å¤è¡Œ
2025-09-29 10:31:18 - caiyuangungun.data.norm.processors.financials.fin_bs_processor - INFO - å‘ç°é‡å¤è®°å½•æ•°é‡: 229682
2025-09-29 10:31:19 - caiyuangungun.data.norm.processors.financials.fin_bs_processor - INFO - å¤„ç†é‡å¤è®°å½•å®Œæˆï¼Œæœ€ç»ˆè¡Œæ•°: 271512
2025-09-29 10:31:19 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤2å®Œæˆ: (386353, 164) -> (271512, 164), è€—æ—¶: 1.62ç§’
2025-09-29 10:31:19 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤3: validate_unique_records (è´¨æ£€) - é‡å¤è®°å½•è´¨æ£€ï¼šæ£€æŸ¥ts_code+end_date+f_ann_dateç»„åˆæ˜¯å¦å­˜åœ¨é‡å¤ï¼Œå¦‚æœå­˜åœ¨é‡å¤è®°å½•åˆ™æŠ¥é”™
2025-09-29 10:31:19 - caiyuangungun.data.norm.processors.financials.fin_bs_processor - INFO - å¼€å§‹é‡å¤è®°å½•è´¨æ£€
2025-09-29 10:31:19 - caiyuangungun.data.norm.processors.financials.fin_bs_processor - INFO - é‡å¤è®°å½•è´¨æ£€é€šè¿‡
2025-09-29 10:31:19 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤3å®Œæˆ: (271512, 164) -> (271512, 164), è€—æ—¶: 0.05ç§’
2025-09-29 10:31:19 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤4: output_parquet_file (è¾“å‡ºå¤„ç†) - è¾“å‡ºparquetæ–‡ä»¶ï¼Œä¿ç•™å…¨éƒ¨å­—æ®µ
2025-09-29 10:31:19 - caiyuangungun.data.norm.services.processor_service - INFO - è·³è¿‡output_parquet_fileï¼Œå°†åœ¨ä¸»æµç¨‹ä¸­å¤„ç†
2025-09-29 10:31:19 - caiyuangungun.data.norm.services.processor_service - INFO - å¤„ç†æµæ°´çº¿æ‰§è¡Œå®Œæˆ
2025-09-29 10:31:19 - caiyuangungun.data.norm.services.processor_service - INFO - ä½¿ç”¨output_parquet_fileæ–¹æ³•ä¿å­˜ç»“æœåˆ°: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/balancesheet/cleaned/balancesheet.parquet
2025-09-29 10:31:19 - caiyuangungun.data.norm.processors.financials.fin_bs_processor - INFO - å¼€å§‹è¾“å‡ºparquetæ–‡ä»¶
2025-09-29 10:31:21 - caiyuangungun.data.norm.processors.financials.fin_bs_processor - INFO - parquetæ–‡ä»¶å·²è¾“å‡ºåˆ°: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/balancesheet/cleaned/balancesheet.parquet
2025-09-29 10:31:21 - caiyuangungun.data.norm.processors.financials.fin_bs_processor - INFO - è¾“å‡ºæ•°æ®å½¢çŠ¶: (271512, 164)
2025-09-29 10:31:21 - caiyuangungun.data.norm.processors.financials.fin_bs_processor - INFO - è¾“å‡ºå­—æ®µæ•°: 164
2025-09-29 10:31:21 - caiyuangungun.data.norm.services.processor_service - INFO - å¤„ç†å™¨æ‰§è¡ŒæˆåŠŸ: fin_bs_processor
2025-09-29 10:31:21 - caiyuangungun.data.norm.services.processor_service - INFO - æ•°æ®å½¢çŠ¶å˜åŒ–: (389933, 164) -> (271512, 164)
2025-09-29 10:31:21 - caiyuangungun.data.norm.services.processor_service - INFO - æ‰§è¡Œæ—¶é—´: 4.64ç§’
2025-09-29 10:31:21 - caiyuangungun.data.norm.services.processor_service - INFO - è¾“å‡ºæ–‡ä»¶å¤§å°: 100.24MB
2025-09-29 10:31:21 - __main__ - INFO - âœ“ fin_bs_processor æ‰§è¡ŒæˆåŠŸ
2025-09-29 10:31:21 - __main__ - INFO -   å¤„ç†æ—¶é—´: 4.64ç§’
2025-09-29 10:31:21 - __main__ - INFO -   è¾“å…¥æ•°æ®å½¢çŠ¶: (389933, 164)
2025-09-29 10:31:21 - __main__ - INFO -   è¾“å‡ºæ•°æ®å½¢çŠ¶: (271512, 164)
2025-09-29 10:31:21 - __main__ - INFO -   è¾“å‡ºæ–‡ä»¶: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/balancesheet/cleaned/balancesheet.parquet
2025-09-29 10:31:21 - __main__ - INFO -   è¾“å‡ºæ–‡ä»¶å¤§å°: 100.24 MB
2025-09-29 10:31:21 - __main__ - INFO - âœ“ è¾“å‡ºæ–‡ä»¶åˆ›å»ºæˆåŠŸ
2025-09-29 10:31:21 - __main__ - INFO - âœ“ æ‰§è¡Œfin_bs_processor æµ‹è¯•é€šè¿‡
2025-09-29 10:31:21 - __main__ - INFO - ----------------------------------------
2025-09-29 10:31:21 - __main__ - INFO - 
å¼€å§‹æµ‹è¯•: æ‰§è¡Œfin_cf_processor
2025-09-29 10:31:21 - __main__ - INFO - ----------------------------------------
2025-09-29 10:31:21 - __main__ - INFO - === æµ‹è¯•ï¼šæ‰§è¡Œ fin_cf_processor ===
2025-09-29 10:31:21 - caiyuangungun.data.norm.services.processor_service - INFO - å¼€å§‹æ‰§è¡Œå¤„ç†å™¨: fin_cf_processor
2025-09-29 10:31:21 - caiyuangungun.data.norm.services.processor_service - INFO - è¾“å…¥è·¯å¾„: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/cashflow/merged/cashflow_y.parquet
2025-09-29 10:31:21 - caiyuangungun.data.norm.services.processor_service - INFO - è¾“å‡ºè·¯å¾„: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/cashflow/cleaned/cashflow_y.parquet
2025-09-29 10:31:21 - caiyuangungun.data.norm.services.processor_service - INFO - ä»é…ç½®æ–‡ä»¶åŠ è½½å¤„ç†å™¨: fin_cf_processor from caiyuangungun.data.norm.processors.financials.fin_cf_processor
2025-09-29 10:31:21 - caiyuangungun.data.norm.processors.financials.fin_cf_processor - ERROR - åŠ è½½é…ç½®æ–‡ä»¶å¤±è´¥: [Errno 2] No such file or directory: '/Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/src/caiyuangungun/data/config/specialized_cleaning_pipeline_config.json'
2025-09-29 10:31:21 - caiyuangungun.data.norm.processors.financials.fin_cf_processor - INFO - FinCFProcessoråˆå§‹åŒ–å®Œæˆï¼Œé…ç½®æ–‡ä»¶: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/src/caiyuangungun/data/config/specialized_cleaning_pipeline_config.json
2025-09-29 10:31:21 - caiyuangungun.data.norm.services.processor_service - INFO - è¯»å–è¾“å…¥æ•°æ®...
2025-09-29 10:31:22 - caiyuangungun.data.norm.services.processor_service - INFO - è¾“å…¥æ•°æ®å½¢çŠ¶: (346886, 103)
2025-09-29 10:31:22 - caiyuangungun.data.norm.services.processor_service - INFO - å¼€å§‹æ‰§è¡Œå¤„ç†æµæ°´çº¿ï¼Œå…±5ä¸ªæ­¥éª¤
2025-09-29 10:31:22 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤1: remove_empty_ts_code (è¡Œå¤„ç†) - å‰”é™¤ts_codeä¸ºç©ºçš„è¡Œï¼Œç¡®ä¿æ¯æ¡è®°å½•éƒ½æœ‰æœ‰æ•ˆçš„è‚¡ç¥¨ä»£ç æ ‡è¯†
2025-09-29 10:31:22 - caiyuangungun.data.norm.processors.financials.fin_cf_processor - INFO - å¼€å§‹ç§»é™¤ts_codeä¸ºç©ºçš„è¡Œ
2025-09-29 10:31:22 - caiyuangungun.data.norm.processors.financials.fin_cf_processor - INFO - ç§»é™¤äº†3679è¡Œts_codeä¸ºç©ºçš„æ•°æ®ï¼Œå‰©ä½™343207è¡Œ
2025-09-29 10:31:22 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤1å®Œæˆ: (346886, 103) -> (343207, 103), è€—æ—¶: 0.57ç§’
2025-09-29 10:31:22 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤2: drop_columns_and_duplicates (è¡Œå¤„ç†) - å‰”é™¤free_cashflowåˆ—ï¼Œç„¶åå¯¹æ‰€æœ‰åˆ—æ‰§è¡Œå»é‡
2025-09-29 10:31:22 - caiyuangungun.data.norm.processors.financials.fin_cf_processor - INFO - å¼€å§‹åˆ é™¤æŒ‡å®šåˆ—å¹¶å»é‡
2025-09-29 10:31:23 - caiyuangungun.data.norm.processors.financials.fin_cf_processor - INFO - åˆ é™¤äº†åˆ—: ['free_cashflow']
2025-09-29 10:31:25 - caiyuangungun.data.norm.processors.financials.fin_cf_processor - INFO - å»é‡å®Œæˆï¼Œåˆ é™¤äº†11è¡Œé‡å¤æ•°æ®ï¼Œå‰©ä½™343196è¡Œ
2025-09-29 10:31:25 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤2å®Œæˆ: (343207, 103) -> (343196, 102), è€—æ—¶: 2.41ç§’
2025-09-29 10:31:25 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤3: handle_duplicate_records (è¡Œå¤„ç†) - å¤„ç†æ›´æ–°é‡å¤è¡Œï¼šæŒ‰ts_codeã€end_dateã€f_ann_dateåˆ†ç»„ï¼Œæ£€æŸ¥é‡å¤æƒ…å†µã€‚å•æ¡è®°å½•ä¿ç•™ï¼Œä¸¤æ¡è®°å½•æ£€æŸ¥update_flagæ˜¯å¦ä¸º0-1ç»„åˆå¹¶ä¿ç•™update_flag=1çš„è®°å½•ï¼Œè¶…è¿‡ä¸¤æ¡è®°å½•åˆ™æŠ¥é”™
2025-09-29 10:31:25 - caiyuangungun.data.norm.processors.financials.fin_cf_processor - INFO - å¼€å§‹å¤„ç†æ›´æ–°é‡å¤è¡Œ
2025-09-29 10:31:25 - caiyuangungun.data.norm.processors.financials.fin_cf_processor - INFO - å‘ç°é‡å¤è®°å½•æ•°é‡: 132624
2025-09-29 10:31:26 - caiyuangungun.data.norm.processors.financials.fin_cf_processor - INFO - å¤„ç†é‡å¤è®°å½•å®Œæˆï¼Œæœ€ç»ˆè¡Œæ•°: 276884
2025-09-29 10:31:26 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤3å®Œæˆ: (343196, 102) -> (276884, 102), è€—æ—¶: 1.05ç§’
2025-09-29 10:31:26 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤4: validate_unique_records (è´¨æ£€) - é‡å¤è®°å½•è´¨æ£€ï¼šæ£€æŸ¥ts_code+end_date+f_ann_dateç»„åˆæ˜¯å¦å­˜åœ¨é‡å¤ï¼Œå¦‚æœå­˜åœ¨é‡å¤è®°å½•åˆ™æŠ¥é”™
2025-09-29 10:31:26 - caiyuangungun.data.norm.processors.financials.fin_cf_processor - INFO - å¼€å§‹é‡å¤è®°å½•è´¨æ£€
2025-09-29 10:31:26 - caiyuangungun.data.norm.processors.financials.fin_cf_processor - INFO - é‡å¤è®°å½•è´¨æ£€é€šè¿‡
2025-09-29 10:31:26 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤4å®Œæˆ: (276884, 102) -> (276884, 102), è€—æ—¶: 0.05ç§’
2025-09-29 10:31:26 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤5: output_parquet_file (è¾“å‡ºå¤„ç†) - è¾“å‡ºparquetæ–‡ä»¶ï¼Œä¿ç•™å…¨éƒ¨å­—æ®µ
2025-09-29 10:31:26 - caiyuangungun.data.norm.services.processor_service - INFO - è·³è¿‡output_parquet_fileï¼Œå°†åœ¨ä¸»æµç¨‹ä¸­å¤„ç†
2025-09-29 10:31:26 - caiyuangungun.data.norm.services.processor_service - INFO - å¤„ç†æµæ°´çº¿æ‰§è¡Œå®Œæˆ
2025-09-29 10:31:26 - caiyuangungun.data.norm.services.processor_service - INFO - ä½¿ç”¨output_parquet_fileæ–¹æ³•ä¿å­˜ç»“æœåˆ°: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/cashflow/cleaned/cashflow_y.parquet
2025-09-29 10:31:26 - caiyuangungun.data.norm.processors.financials.fin_cf_processor - INFO - å¼€å§‹è¾“å‡ºparquetæ–‡ä»¶
2025-09-29 10:31:28 - caiyuangungun.data.norm.processors.financials.fin_cf_processor - INFO - parquetæ–‡ä»¶å·²è¾“å‡ºåˆ°: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/cashflow/cleaned/cashflow_y.parquet
2025-09-29 10:31:28 - caiyuangungun.data.norm.processors.financials.fin_cf_processor - INFO - è¾“å‡ºæ•°æ®å½¢çŠ¶: (276884, 102)
2025-09-29 10:31:28 - caiyuangungun.data.norm.processors.financials.fin_cf_processor - INFO - è¾“å‡ºå­—æ®µæ•°: 102
2025-09-29 10:31:28 - caiyuangungun.data.norm.services.processor_service - INFO - å¤„ç†å™¨æ‰§è¡ŒæˆåŠŸ: fin_cf_processor
2025-09-29 10:31:28 - caiyuangungun.data.norm.services.processor_service - INFO - æ•°æ®å½¢çŠ¶å˜åŒ–: (346886, 103) -> (276884, 102)
2025-09-29 10:31:28 - caiyuangungun.data.norm.services.processor_service - INFO - æ‰§è¡Œæ—¶é—´: 6.56ç§’
2025-09-29 10:31:28 - caiyuangungun.data.norm.services.processor_service - INFO - è¾“å‡ºæ–‡ä»¶å¤§å°: 81.45MB
2025-09-29 10:31:28 - __main__ - INFO - âœ“ fin_cf_processor æ‰§è¡ŒæˆåŠŸ
2025-09-29 10:31:28 - __main__ - INFO -   å¤„ç†æ—¶é—´: 6.56ç§’
2025-09-29 10:31:28 - __main__ - INFO -   è¾“å…¥æ•°æ®å½¢çŠ¶: (346886, 103)
2025-09-29 10:31:28 - __main__ - INFO -   è¾“å‡ºæ•°æ®å½¢çŠ¶: (276884, 102)
2025-09-29 10:31:28 - __main__ - INFO -   è¾“å‡ºæ–‡ä»¶: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/cashflow/cleaned/cashflow_y.parquet
2025-09-29 10:31:28 - __main__ - INFO -   è¾“å‡ºæ–‡ä»¶å¤§å°: 81.45 MB
2025-09-29 10:31:28 - __main__ - INFO - âœ“ è¾“å‡ºæ–‡ä»¶åˆ›å»ºæˆåŠŸ
2025-09-29 10:31:28 - __main__ - INFO - âœ“ æ‰§è¡Œfin_cf_processor æµ‹è¯•é€šè¿‡
2025-09-29 10:31:28 - __main__ - INFO - ----------------------------------------
2025-09-29 10:31:28 - __main__ - INFO - 
å¼€å§‹æµ‹è¯•: æ‰§è¡Œfin_indicator_processor
2025-09-29 10:31:28 - __main__ - INFO - ----------------------------------------
2025-09-29 10:31:28 - __main__ - INFO - === æµ‹è¯•ï¼šæ‰§è¡Œ fin_indicator_processor ===
2025-09-29 10:31:28 - caiyuangungun.data.norm.services.processor_service - INFO - å¼€å§‹æ‰§è¡Œå¤„ç†å™¨: fin_indicator_processor
2025-09-29 10:31:28 - caiyuangungun.data.norm.services.processor_service - INFO - è¾“å…¥è·¯å¾„: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/fina_indicator/merged/fina_indicator_vip.parquet
2025-09-29 10:31:28 - caiyuangungun.data.norm.services.processor_service - INFO - è¾“å‡ºè·¯å¾„: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/fina_indicator/cleaned/fina_indicator_vip.parquet
2025-09-29 10:31:28 - caiyuangungun.data.norm.services.processor_service - INFO - ä»é…ç½®æ–‡ä»¶åŠ è½½å¤„ç†å™¨: fin_indicator_processor from caiyuangungun.data.norm.processors.financials.fin_indicator_processor
2025-09-29 10:31:28 - caiyuangungun.data.norm.processors.financials.fin_indicator_processor - ERROR - åŠ è½½é…ç½®æ–‡ä»¶å¤±è´¥: [Errno 2] No such file or directory: '/Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/src/caiyuangungun/data/config/specialized_cleaning_pipeline_config.json'
2025-09-29 10:31:28 - caiyuangungun.data.norm.processors.financials.fin_indicator_processor - INFO - FinIndicatorProcessoråˆå§‹åŒ–å®Œæˆï¼Œé…ç½®æ–‡ä»¶: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/src/caiyuangungun/data/config/specialized_cleaning_pipeline_config.json
2025-09-29 10:31:28 - caiyuangungun.data.norm.services.processor_service - INFO - è¯»å–è¾“å…¥æ•°æ®...
2025-09-29 10:31:29 - caiyuangungun.data.norm.services.processor_service - INFO - è¾“å…¥æ•°æ®å½¢çŠ¶: (539737, 173)
2025-09-29 10:31:29 - caiyuangungun.data.norm.services.processor_service - INFO - å¼€å§‹æ‰§è¡Œå¤„ç†æµæ°´çº¿ï¼Œå…±5ä¸ªæ­¥éª¤
2025-09-29 10:31:29 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤1: remove_empty_ts_code (è¡Œå¤„ç†) - å‰”é™¤ts_codeä¸ºç©ºçš„è¡Œï¼Œç¡®ä¿æ¯æ¡è®°å½•éƒ½æœ‰æœ‰æ•ˆçš„è‚¡ç¥¨ä»£ç æ ‡è¯†
2025-09-29 10:31:29 - caiyuangungun.data.norm.processors.financials.fin_indicator_processor - INFO - å¼€å§‹ç§»é™¤ts_codeä¸ºç©ºçš„è¡Œ
2025-09-29 10:31:30 - caiyuangungun.data.norm.processors.financials.fin_indicator_processor - INFO - ç§»é™¤äº†14569è¡Œts_codeä¸ºç©ºçš„æ•°æ®ï¼Œå‰©ä½™525168è¡Œ
2025-09-29 10:31:30 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤1å®Œæˆ: (539737, 173) -> (525168, 173), è€—æ—¶: 1.13ç§’
2025-09-29 10:31:30 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤2: drop_columns_and_duplicates (è¡Œå¤„ç†) - å‰”é™¤fcffå’Œfcfeåˆ—ï¼Œç„¶åå¯¹æ‰€æœ‰åˆ—æ‰§è¡Œå»é‡
2025-09-29 10:31:30 - caiyuangungun.data.norm.processors.financials.fin_indicator_processor - INFO - å¼€å§‹åˆ é™¤æŒ‡å®šåˆ—å¹¶å»é‡
2025-09-29 10:31:31 - caiyuangungun.data.norm.processors.financials.fin_indicator_processor - INFO - åˆ é™¤äº†åˆ—: ['fcff', 'fcfe']
2025-09-29 10:31:39 - caiyuangungun.data.norm.processors.financials.fin_indicator_processor - INFO - å»é‡å®Œæˆï¼Œåˆ é™¤äº†0è¡Œé‡å¤æ•°æ®ï¼Œå‰©ä½™525168è¡Œ
2025-09-29 10:31:39 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤2å®Œæˆ: (525168, 173) -> (525168, 171), è€—æ—¶: 8.98ç§’
2025-09-29 10:31:39 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤3: handle_duplicate_records (è¡Œå¤„ç†) - å¤„ç†æ›´æ–°é‡å¤è¡Œï¼šæŒ‰ts_codeã€end_dateã€ann_dateåˆ†ç»„ï¼Œæ£€æŸ¥é‡å¤æƒ…å†µã€‚å•æ¡è®°å½•ä¿ç•™ï¼Œä¸¤æ¡è®°å½•æ£€æŸ¥update_flagæ˜¯å¦ä¸º0-1ç»„åˆå¹¶ä¿ç•™update_flag=1çš„è®°å½•ï¼Œè¶…è¿‡ä¸¤æ¡è®°å½•åˆ™æŠ¥é”™ï¼Œä¸ç”¨fanndateæ˜¯å› ä¸ºè´¢åŠ¡æŒ‡æ ‡æ•°æ®æºæ²¡æœ‰fanndate
2025-09-29 10:31:39 - caiyuangungun.data.norm.processors.financials.fin_indicator_processor - INFO - å¼€å§‹å¤„ç†æ›´æ–°é‡å¤è¡Œ
2025-09-29 10:31:40 - caiyuangungun.data.norm.processors.financials.fin_indicator_processor - INFO - å‘ç°é‡å¤è®°å½•æ•°é‡: 480952
2025-09-29 10:31:42 - caiyuangungun.data.norm.processors.financials.fin_indicator_processor - INFO - å¤„ç†é‡å¤è®°å½•å®Œæˆï¼Œæœ€ç»ˆè¡Œæ•°: 284688
2025-09-29 10:31:42 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤3å®Œæˆ: (525168, 171) -> (284688, 171), è€—æ—¶: 2.62ç§’
2025-09-29 10:31:42 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤4: validate_unique_records (è´¨æ£€) - é‡å¤è®°å½•è´¨æ£€ï¼šæ£€æŸ¥ts_code+end_date+ann_dateç»„åˆæ˜¯å¦å­˜åœ¨é‡å¤ï¼Œå¦‚æœå­˜åœ¨é‡å¤è®°å½•åˆ™æŠ¥é”™
2025-09-29 10:31:42 - caiyuangungun.data.norm.processors.financials.fin_indicator_processor - INFO - å¼€å§‹é‡å¤è®°å½•è´¨æ£€
2025-09-29 10:31:42 - caiyuangungun.data.norm.processors.financials.fin_indicator_processor - INFO - é‡å¤è®°å½•è´¨æ£€é€šè¿‡
2025-09-29 10:31:42 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤4å®Œæˆ: (284688, 171) -> (284688, 171), è€—æ—¶: 0.06ç§’
2025-09-29 10:31:42 - caiyuangungun.data.norm.services.processor_service - INFO - æ­¥éª¤5: output_parquet_file (è¾“å‡ºå¤„ç†) - è¾“å‡ºparquetæ–‡ä»¶ï¼Œä¿ç•™å…¨éƒ¨å­—æ®µ
2025-09-29 10:31:42 - caiyuangungun.data.norm.services.processor_service - INFO - è·³è¿‡output_parquet_fileï¼Œå°†åœ¨ä¸»æµç¨‹ä¸­å¤„ç†
2025-09-29 10:31:42 - caiyuangungun.data.norm.services.processor_service - INFO - å¤„ç†æµæ°´çº¿æ‰§è¡Œå®Œæˆ
2025-09-29 10:31:42 - caiyuangungun.data.norm.services.processor_service - INFO - ä½¿ç”¨output_parquet_fileæ–¹æ³•ä¿å­˜ç»“æœåˆ°: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/fina_indicator/cleaned/fina_indicator_vip.parquet
2025-09-29 10:31:42 - caiyuangungun.data.norm.processors.financials.fin_indicator_processor - INFO - å¼€å§‹è¾“å‡ºparquetæ–‡ä»¶
2025-09-29 10:31:46 - caiyuangungun.data.norm.processors.financials.fin_indicator_processor - INFO - parquetæ–‡ä»¶å·²è¾“å‡ºåˆ°: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/fina_indicator/cleaned/fina_indicator_vip.parquet
2025-09-29 10:31:46 - caiyuangungun.data.norm.processors.financials.fin_indicator_processor - INFO - è¾“å‡ºæ•°æ®å½¢çŠ¶: (284688, 171)
2025-09-29 10:31:46 - caiyuangungun.data.norm.processors.financials.fin_indicator_processor - INFO - è¾“å‡ºå­—æ®µæ•°: 171
2025-09-29 10:31:46 - caiyuangungun.data.norm.services.processor_service - INFO - å¤„ç†å™¨æ‰§è¡ŒæˆåŠŸ: fin_indicator_processor
2025-09-29 10:31:46 - caiyuangungun.data.norm.services.processor_service - INFO - æ•°æ®å½¢çŠ¶å˜åŒ–: (539737, 173) -> (284688, 171)
2025-09-29 10:31:46 - caiyuangungun.data.norm.services.processor_service - INFO - æ‰§è¡Œæ—¶é—´: 17.69ç§’
2025-09-29 10:31:46 - caiyuangungun.data.norm.services.processor_service - INFO - è¾“å‡ºæ–‡ä»¶å¤§å°: 231.77MB
2025-09-29 10:31:47 - __main__ - INFO - âœ“ fin_indicator_processor æ‰§è¡ŒæˆåŠŸ
2025-09-29 10:31:47 - __main__ - INFO -   å¤„ç†æ—¶é—´: 17.69ç§’
2025-09-29 10:31:47 - __main__ - INFO -   è¾“å…¥æ•°æ®å½¢çŠ¶: (539737, 173)
2025-09-29 10:31:47 - __main__ - INFO -   è¾“å‡ºæ•°æ®å½¢çŠ¶: (284688, 171)
2025-09-29 10:31:47 - __main__ - INFO -   è¾“å‡ºæ–‡ä»¶: /Users/daishun/ä¸ªäººæ–‡æ¡£/caiyuangungun/data/norm/fina_indicator/cleaned/fina_indicator_vip.parquet
2025-09-29 10:31:47 - __main__ - INFO -   è¾“å‡ºæ–‡ä»¶å¤§å°: 231.77 MB
2025-09-29 10:31:47 - __main__ - INFO - âœ“ è¾“å‡ºæ–‡ä»¶åˆ›å»ºæˆåŠŸ
2025-09-29 10:31:47 - __main__ - INFO - âœ“ æ‰§è¡Œfin_indicator_processor æµ‹è¯•é€šè¿‡
2025-09-29 10:31:47 - __main__ - INFO - ----------------------------------------
2025-09-29 10:31:47 - __main__ - INFO - 
============================================================
2025-09-29 10:31:47 - __main__ - INFO - æµ‹è¯•æ€»ç»“
2025-09-29 10:31:47 - __main__ - INFO - ============================================================
2025-09-29 10:31:47 - __main__ - INFO - é…ç½®ç®¡ç†å™¨é›†æˆ: âœ“ é€šè¿‡
2025-09-29 10:31:47 - __main__ - INFO - åˆ—å‡ºå¤„ç†å™¨: âœ“ é€šè¿‡
2025-09-29 10:31:47 - __main__ - INFO - è·å–å¤„ç†å™¨ä¿¡æ¯: âœ“ é€šè¿‡
2025-09-29 10:31:47 - __main__ - INFO - æ‰§è¡Œfin_is_processor: âœ“ é€šè¿‡
2025-09-29 10:31:47 - __main__ - INFO - æ‰§è¡Œfin_bs_processor: âœ“ é€šè¿‡
2025-09-29 10:31:47 - __main__ - INFO - æ‰§è¡Œfin_cf_processor: âœ“ é€šè¿‡
2025-09-29 10:31:47 - __main__ - INFO - æ‰§è¡Œfin_indicator_processor: âœ“ é€šè¿‡
2025-09-29 10:31:47 - __main__ - INFO - 
æ€»è®¡: 7/7 ä¸ªæµ‹è¯•é€šè¿‡
2025-09-29 10:31:47 - __main__ - INFO - ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ProcessorService åŠŸèƒ½æ­£å¸¸
2025-09-29 10:31:47 - __main__ - INFO - 
ğŸ¯ æµ‹è¯•ç»“è®º: ProcessorService å·²å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥æŠ•å…¥ä½¿ç”¨
2025-09-29 10:31:47 - __main__ - INFO - ğŸ’¡ ä½¿ç”¨æ–¹æ³•: è¾“å…¥ 'fin_is_processor' å³å¯ç›´æ¥è¾“å‡ºæœ€ç»ˆçš„parquetæ–‡ä»¶
